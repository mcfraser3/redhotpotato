(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    156199,       3951]
NotebookOptionsPosition[    153736,       3865]
NotebookOutlinePosition[    154082,       3880]
CellTagsIndexPosition[    154039,       3877]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Red Hot Potato Algorithm", "Title",
 CellChangeTimes->{{3.6986649132299533`*^9, 3.6986649572979555`*^9}}],

Cell[CellGroupData[{

Cell["Building-block Functions", "Section",
 CellChangeTimes->{{3.7005589861963067`*^9, 3.7005589915933576`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"both", "[", 
    RowBox[{"f_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "&&", 
    RowBox[{"f", "[", "y", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NiceGraph", "[", 
    RowBox[{"v_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Graph", "[", 
    RowBox[{"v", ",", "e", ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
     RowBox[{"GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outdegree0or1", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "0"}], "]"}], "+", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "1"}], "]"}]}], 
    "\[Equal]", 
    RowBox[{"Length", "[", 
     RowBox[{"VertexOutDegree", "[", "x", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"root", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"VertexOutDegree", "[", 
     RowBox[{"x", ",", "n"}], "]"}], "\[Equal]", "0"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numroot", "[", "x_", "]"}], ":=", 
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "0"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsto", "[", 
    RowBox[{"x_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"FindSpanningTree", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "n1"}], "}"}], "]"}], "]"}], ",", "n2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cycle", "[", "x_", "]"}], ":=", 
   RowBox[{"Graph", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"FindCycle", "[", 
      RowBox[{"x", ",", "Infinity", ",", "All"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnRed", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"SetProperty", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "e"}], "}"}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Red"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnBlack", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"SetProperty", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "e"}], "}"}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Black"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxCycle", "[", "x_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"FindCycle", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"VertexList", "[", 
         RowBox[{"Cycle", "[", "x", "]"}], "]"}], "]"}]}], "}"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BetterFirst", "[", "s_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"s", "!=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"First", "[", "s", "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgeOut", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"BetterFirst", "[", 
    RowBox[{"EdgeList", "[", 
     RowBox[{"x", ",", 
      RowBox[{"DirectedEdge", "[", 
       RowBox[{"i", ",", "_"}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsRed", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"EdgeOut", "[", 
           RowBox[{"x", ",", "i"}], "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}],
       "}"}], ",", "Red"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsBlack", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"EdgeOut", "[", 
           RowBox[{"x", ",", "i"}], "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}],
       "}"}], ",", "Black"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Colored", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "e"}], "}"}], ",", "EdgeStyle"}], "]"}], "}"}], 
     ",", "Red"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestCycle", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Colored", "[", 
      RowBox[{"x", ",", 
       RowBox[{"First", "[", 
        RowBox[{"MaxCycle", "[", "x", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"TurnBlack", "[", 
      RowBox[{"x", ",", 
       RowBox[{"MaxCycle", "[", "x", "]"}]}], "]"}], ",", 
     RowBox[{"TurnRed", "[", 
      RowBox[{"x", ",", 
       RowBox[{"MaxCycle", "[", "x", "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxCycleVertex", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"Cycle", "[", "x", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"VertexList", "[", 
        RowBox[{"Cycle", "[", "x", "]"}], "]"}], ",", 
       RowBox[{"VertexList", "[", 
        RowBox[{"Cycle", "[", "y", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InTree", "[", 
    RowBox[{"x_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"FindSpanningTree", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "n1"}], "}"}], "]"}], "]"}], ",", "n2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpanningTree", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"EdgeList", "[", 
    RowBox[{"FindSpanningTree", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "i"}], "}"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"succ", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"x", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"n", ",", "_"}], "]"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RedEdges", "[", "x_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", "0"}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"VertexList", "[", "x", "]"}], ",", "a"}], "]"}], ",", 
       RowBox[{"a", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"EdgeList", "[", 
            RowBox[{"x", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"a", ",", "_"}], "]"}]}], "]"}], "]"}], "\[Equal]", 
          "0"}], ",", 
         RowBox[{"b", "\[Equal]", "b"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"len", "=", "1"}], ",", 
           RowBox[{"len", "<", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"a", ",", "_"}], "]"}]}], "]"}], "]"}], "+", "1"}], 
             ")"}]}], ",", 
           RowBox[{"len", "++"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"PropertyValue", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a", ",", "_"}], "]"}]}], "]"}], ",", "len"}], 
                    "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}], "}"}], ",", 
               "Red"}], "]"}], ",", 
             RowBox[{"b", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"b", ",", 
                RowBox[{"{", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a", ",", "_"}], "]"}]}], "]"}], ",", "len"}], 
                  "]"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"b", "=", "b"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";",
      "b"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Deletei", "[", 
    RowBox[{"x_", ",", "edges_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"edges", ",", 
     RowBox[{"EdgeOut", "[", 
      RowBox[{"x", ",", "i"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Addi", "[", 
    RowBox[{"x_", ",", "edges_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Append", "[", 
     RowBox[{"edges", ",", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"x", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PathSoFar", "[", 
    RowBox[{"n_", ",", "v_", ",", "edge_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sf", "=", "1"}], ";", 
      RowBox[{"vl", "=", 
       RowBox[{"{", "}"}]}]}], ",", 
     RowBox[{"sf", "<", "v"}], ",", 
     RowBox[{"sf", "++"}], ",", 
     RowBox[{"vl", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"vl", ",", 
         RowBox[{"FindPath", "[", 
          RowBox[{
           RowBox[{"NiceGraph", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"n", "-", "1"}]}], "]"}], ",", "edge"}], "]"}], ",", 
           "sf", ",", "v"}], "]"}]}], "]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DeleteCasesSuper", "[", 
    RowBox[{"origlist_", ",", "deletelist_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o", "=", "0"}], ";", 
      RowBox[{"finallist", "=", "origlist"}]}], ",", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"origlist", ",", "o"}], "]"}], ",", 
     RowBox[{"o", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"deletelist", ",", "o"}], "]"}], ",", 
       RowBox[{"finallist", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"finallist", ",", "o"}], "]"}]}], ",", 
       RowBox[{"finallist", "=", "finallist"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomTree", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", "1"}], ";", 
        RowBox[{"vert", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"v", "<", "n"}], ",", 
       RowBox[{"v", "++"}], ",", 
       RowBox[{
        RowBox[{"PathSoFar", "[", 
         RowBox[{"n", ",", "v", ",", "edge"}], "]"}], ";", 
        RowBox[{"DeleteCasesSuper", "[", 
         RowBox[{"vert", ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", "vl"}], "]"}]}], "]"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"v", ",", 
              RowBox[{"RandomChoice", "[", "finallist", "]"}]}], "]"}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vert", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Random3Forest", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", "3"}], ";", 
        RowBox[{"vert", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"v", "<", "n"}], ",", 
       RowBox[{"v", "++"}], ",", 
       RowBox[{
        RowBox[{"PathSoFar", "[", 
         RowBox[{"n", ",", "v", ",", "edge"}], "]"}], ";", 
        RowBox[{"DeleteCasesSuper", "[", 
         RowBox[{"vert", ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", "vl"}], "]"}]}], "]"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"v", ",", 
              RowBox[{"RandomChoice", "[", "finallist", "]"}]}], "]"}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vert", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DandelionTree", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "2"}], ";", 
        RowBox[{"code", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", 
           RowBox[{"n", "-", "2"}]}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"code", ",", "1"}], "]"}]}], ";", 
        RowBox[{"m", "=", "0"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", 
          RowBox[{"1", "\[Rule]", "0"}], "}"}]}], ";", 
        RowBox[{"vertices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}]}], ",", 
       RowBox[{"i", "<", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"code", ",", 
           RowBox[{"i", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"i", "\[Rule]", "k"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FindCycle", "[", 
             RowBox[{"NiceGraph", "[", 
              RowBox[{"vertices", ",", "edge"}], "]"}], "]"}], "==", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"k", "\[NotEqual]", "i"}]}], ",", 
          RowBox[{"edge", "=", "edge"}], ",", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{"First", "[", 
             RowBox[{"succ", "[", 
              RowBox[{
               RowBox[{"NiceGraph", "[", 
                RowBox[{"vertices", ",", "edge"}], "]"}], ",", "1"}], "]"}], 
             "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"i", "\[Rule]", "k"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"{", 
               RowBox[{"1", "\[Rule]", "k"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"1", "\[Rule]", "m"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"{", 
               RowBox[{"i", "\[Rule]", "m"}], "}"}]}], "]"}]}]}]}], "]"}]}]}],
       "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vertices", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Prufer3Forest", "[", "n_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"vertices", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
    RowBox[{"edge", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"r", "=", 
     RowBox[{"RandomInteger", "[", "2", "]"}]}], ";", 
    RowBox[{"P", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"3", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
    RowBox[{"Nu", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"n", "-", "1"}], ",", 
       RowBox[{"n", "-", "4"}]}], "]"}]}], ";", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"index", "=", "1"}], ";", 
         RowBox[{"t", "=", "0"}]}], ",", 
        RowBox[{"t", "<", "1"}], ",", 
        RowBox[{"index", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Nu", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"P", ",", "index"}], "]"}]}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"edge", "=", "edge"}], ";", 
            RowBox[{"t", "=", "0"}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"edge", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"edge", ",", 
               RowBox[{"{", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"P", ",", "index"}], "]"}], ",", 
                  RowBox[{"First", "[", "Nu", "]"}]}], "]"}], "}"}]}], 
              "]"}]}], ";", 
            RowBox[{"P", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"P", ",", "index"}], "]"}]}], ";", 
            RowBox[{"Nu", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"Nu", ",", "1"}], "]"}]}], ";", 
            RowBox[{"t", "=", "1"}]}], ")"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"step", ",", 
        RowBox[{"n", "-", "4"}]}], "}"}]}], "]"}], ";", 
    RowBox[{"edge", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"edge", ",", 
       RowBox[{"{", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{
          RowBox[{"First", "[", "P", "]"}], ",", "r"}], "]"}], "}"}]}], 
      "]"}]}], ";", 
    RowBox[{"NiceGraph", "[", 
     RowBox[{"vertices", ",", "edge"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7005590496639533`*^9, 3.7005590629681454`*^9}, {
   3.700559099672021*^9, 3.700559251457455*^9}, {3.700559321450947*^9, 
   3.700559405972663*^9}, {3.7005598942707624`*^9, 3.7005599191546865`*^9}, {
   3.700560011072984*^9, 3.7005600475026436`*^9}, {3.7005646359201746`*^9, 
   3.700564672608961*^9}, {3.7005662811568823`*^9, 3.7005662875978336`*^9}, {
   3.7005671291664133`*^9, 3.700567151513558*^9}, {3.700570131069575*^9, 
   3.7005701612141886`*^9}, {3.7005701921322803`*^9, 3.700570214500474*^9}, {
   3.7005702736742306`*^9, 3.700570295679549*^9}, {3.700570407820699*^9, 
   3.7005704417590528`*^9}, {3.7005705014324827`*^9, 3.700570533130789*^9}, {
   3.7005705836221714`*^9, 3.700570584076339*^9}, {3.7005706323560486`*^9, 
   3.700570684408392*^9}, {3.700570909746811*^9, 3.7005709420720396`*^9}, {
   3.7005709845384073`*^9, 3.7005709849861813`*^9}, {3.7005710502913146`*^9, 
   3.7005710506316977`*^9}, {3.700571094059413*^9, 3.7005711119086657`*^9}, {
   3.7005713521501875`*^9, 3.700571376829774*^9}, {3.700571520412264*^9, 
   3.700571552647217*^9}, {3.7005717142972913`*^9, 3.7005717152684608`*^9}, {
   3.700571834753085*^9, 3.7005718378371315`*^9}, {3.7005723785655165`*^9, 
   3.700572405501684*^9}, {3.7005775310670986`*^9, 3.700577532069551*^9}, {
   3.7005775650291147`*^9, 3.700577565916607*^9}, {3.7005776804991007`*^9, 
   3.700577789006296*^9}, {3.7005784268495426`*^9, 3.700578471977148*^9}, {
   3.7005785088179436`*^9, 3.700578514275432*^9}, {3.700578696228074*^9, 
   3.700578711638076*^9}, {3.7005788549812875`*^9, 3.7005788962543383`*^9}, {
   3.7005790704158983`*^9, 3.700579091872998*^9}, {3.7005791527195716`*^9, 
   3.7005791599279113`*^9}, 3.7009102872898235`*^9, {3.7009913977395115`*^9, 
   3.7009914421868534`*^9}, {3.700994416182477*^9, 3.7009944165608563`*^9}, 
   3.7010118513560853`*^9, {3.701606318482174*^9, 3.7016063188799715`*^9}, {
   3.7020369488122897`*^9, 3.7020369496651015`*^9}, 3.7020478339599934`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Functions", "Section",
 CellChangeTimes->{{3.698664972927446*^9, 3.698664980277646*^9}, {
  3.7005589971590853`*^9, 3.700559000854458*^9}}],

Cell[CellGroupData[{

Cell["Are my two graphs trees?", "Subsection",
 CellChangeTimes->{{3.700560095523822*^9, 3.7005601026571245`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Trees", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"both", "[", 
    RowBox[{"AcyclicGraphQ", ",", "x", ",", "y"}], "]"}], "&&", 
   RowBox[{"both", "[", 
    RowBox[{"outdegree0or1", ",", "x", ",", "y"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7005609618677936`*^9, 3.700561004983028*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Does one have a root at 0 and the other roots at 0,1,2?", "Subsection",
 CellChangeTimes->{{3.69866502994809*^9, 3.6986650531712604`*^9}, {
   3.698665104182068*^9, 3.6986651341106873`*^9}, 3.700561085838233*^9, 
   3.7005611388082867`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThreeForest", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "1"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "1"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "3"}]}], "||", 
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "1"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "3"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6986651366258407`*^9, 3.6986651366258407`*^9}, 
   3.7005610893834333`*^9, {3.7005613257319727`*^9, 3.7005613437038584`*^9}, {
   3.7005643845778236`*^9, 3.700564455679778*^9}, {3.700564491846811*^9, 
   3.7005645238832884`*^9}, {3.700567058431872*^9, 3.7005670589692025`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are they one of the three kinds of acceptable two-forests?", \
"Subsection",
 CellChangeTimes->{{3.6986651501209764`*^9, 3.6986651596472936`*^9}, 
   3.700561097659435*^9, 3.700564582575466*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoForesta", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "1", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "2", ",", "1"}], "]"}]}], "||", 
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "1", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "2", ",", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.7005610950985727`*^9, {3.700564592159292*^9, 3.700564606627499*^9}, {
   3.7005663319978695`*^9, 3.7005664642625194`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoForestb", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "1", ",", "2"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "2", ",", "0"}], "]"}]}], "||", 
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "1", ",", "2"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "2", ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6986652024769573`*^9, 3.698665217403883*^9}, 
   3.700561134862652*^9, {3.700566523772192*^9, 3.7005666835399847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TwoForestc", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "1", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "2", ",", "0"}], "]"}]}], "||", 
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "1", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "2", ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.700564568245941*^9, {3.7005667216009345`*^9, 3.700566838093274*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are they the improper kind of two-forests?", "Subsection",
 CellChangeTimes->{{3.698665252395567*^9, 3.6986652703881383`*^9}, 
   3.700566884389189*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BadForest", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "1", ",", "2"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "2", ",", "1"}], "]"}]}], "||", 
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"y", ",", "2"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "y", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"y", ",", "1", ",", "2"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "&&", 
    RowBox[{"root", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "&&", 
    RowBox[{
     RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "2"}], "&&", 
    RowBox[{"pointsto", "[", 
     RowBox[{"x", ",", "2", ",", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6986653066556005`*^9, 3.698665324256181*^9}, {
  3.700566890299917*^9, 3.700566989720994*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are the two graphs forests of the appropriate kind?", "Subsection",
 CellChangeTimes->{{3.698753892994501*^9, 3.6987539254650545`*^9}, 
   3.7005670139157095`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Proper", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Trees", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "&&", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ThreeForest", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "||", 
     RowBox[{"TwoForesta", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "||", 
     RowBox[{"TwoForestb", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "||", 
     RowBox[{"TwoForestc", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7005670210166583`*^9, 3.7005670946862416`*^9}, {
  3.7009070542099047`*^9, 3.7009070720368285`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Highlighting the appropriate cycle (if there is one) or changing the color of \
meta-edges\
\>", "Subsection",
 CellChangeTimes->{{3.698665332431614*^9, 3.6986653609745617`*^9}, {
  3.7005707230437145`*^9, 3.700570732859806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi0", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"both", "[", 
      RowBox[{"AcyclicGraphQ", ",", "x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AcyclicGraphQ", "[", "x", "]"}]}], "&&", 
       RowBox[{"AcyclicGraphQ", "[", "y", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"HighestCycle", "[", "x", "]"}], ",", "y"}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"AcyclicGraphQ", "[", "y", "]"}]}], "&&", 
         RowBox[{"AcyclicGraphQ", "[", "x", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"HighestCycle", "[", "y", "]"}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MaxCycleVertex", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"MaxCycleVertex", "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"HighestCycle", "[", "x", "]"}], ",", "y"}], "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MaxCycleVertex", "[", 
              RowBox[{"y", ",", "x"}], "]"}], "&&", 
             RowBox[{"!", 
              RowBox[{"MaxCycleVertex", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"HighestCycle", "[", "y", "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"VertexOutDegree", "[", 
                RowBox[{"x", ",", "1"}], "]"}], "\[Equal]", "1"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"HighestCycle", "[", "x", "]"}], ",", "y"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"HighestCycle", "[", "y", "]"}]}], "}"}]}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.700570719884756*^9, 3.700571323557891*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi2", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"both", "[", 
      RowBox[{"AcyclicGraphQ", ",", "x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"phi0", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"BadForest", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"InTree", "[", 
         RowBox[{"x", ",", "1", ",", "2"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IsRed", "[", 
           RowBox[{"x", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TurnBlack", "[", 
             RowBox[{"x", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"x", ",", "1"}], "]"}]}], "]"}], ",", 
            RowBox[{"TurnBlack", "[", 
             RowBox[{"y", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"y", ",", "2"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TurnRed", "[", 
             RowBox[{"x", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"x", ",", "1"}], "]"}]}], "]"}], ",", 
            RowBox[{"TurnRed", "[", 
             RowBox[{"y", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"y", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IsRed", "[", 
           RowBox[{"y", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TurnBlack", "[", 
             RowBox[{"x", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"x", ",", "2"}], "]"}]}], "]"}], ",", 
            RowBox[{"TurnBlack", "[", 
             RowBox[{"y", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"y", ",", "1"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TurnRed", "[", 
             RowBox[{"x", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"x", ",", "2"}], "]"}]}], "]"}], ",", 
            RowBox[{"TurnRed", "[", 
             RowBox[{"y", ",", 
              RowBox[{"SpanningTree", "[", 
               RowBox[{"y", ",", "1"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.698665396477934*^9, 3.6986654082070184`*^9}, {
   3.69875661780729*^9, 3.698756624472707*^9}, {3.700570729220693*^9, 
   3.700570752011017*^9}, 3.7005725898043165`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Moves an edge coming out of node i from x to y or vice versa, or a specified \
edge (inputted DirectedEdge[i,j])\
\>", "Subsection",
 CellChangeTimes->{3.7005805545596933`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2y", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"x", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6986654578023233`*^9, 3.6986654759362864`*^9}, 
   3.6986671309080877`*^9, 3.6987526303175554`*^9, 3.698753137589508*^9, {
   3.698756629496007*^9, 3.6987566301391525`*^9}, {3.7005671238383007`*^9, 
   3.700567145315336*^9}, {3.7005671922733345`*^9, 3.700567198539288*^9}, 
   3.7005707398467407`*^9, {3.700571196594368*^9, 3.7005712468881598`*^9}, 
   3.700571318379902*^9, {3.7005714166305428`*^9, 3.70057142313443*^9}, {
   3.7005714717915354`*^9, 3.700571473051661*^9}, {3.700571588365794*^9, 
   3.7005715918463335`*^9}, {3.7005718512575493`*^9, 
   3.7005718545419245`*^9}, {3.7005719150145493`*^9, 3.7005719332833166`*^9}, 
   3.7005719897137666`*^9, {3.7005720603421073`*^9, 3.7005720958044205`*^9}, {
   3.7005721308113365`*^9, 3.7005721588924885`*^9}, {3.700572196308391*^9, 
   3.700572199645521*^9}, {3.700572232570962*^9, 3.7005722387371387`*^9}, {
   3.700572277600705*^9, 3.7005723375726585`*^9}, {3.7005724444277077`*^9, 
   3.700572546632223*^9}, 3.700572586316552*^9, 3.700580532334691*^9, {
   3.7005805655882063`*^9, 3.7005805874858136`*^9}, 3.7009103863714037`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2x", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"y", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "x", "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6987610771677327`*^9, 3.6987610865358257`*^9}, 
   3.700577521771679*^9, {3.700580598507406*^9, 3.7005805996802697`*^9}, 
   3.7009104052924876`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2yEdge", "[", 
   RowBox[{"x_", ",", "y_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Colored", "[", 
     RowBox[{"x", ",", "e"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", 
          RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.700577518862233*^9, 3.700580630967164*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2xEdge", "[", 
   RowBox[{"x_", ",", "y_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Colored", "[", 
     RowBox[{"y", ",", "e"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", 
          RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"RedEdges", "[", "x", "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6998903260715113`*^9, 3.6998903354793873`*^9}, 
   3.700577546960593*^9, {3.7005806528231134`*^9, 3.7005806538152504`*^9}, {
   3.700911455066657*^9, 3.7009114554664927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2ydouble", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"x", ",", "i"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"y", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "x", "]"}], ",", 
            RowBox[{"EdgeList", "[", "x", "]"}]}], "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "y", "]"}], ",", 
            RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}],
        "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"y", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "x", "]"}], ",", 
            RowBox[{"EdgeList", "[", "x", "]"}]}], "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "y", "]"}], ",", 
            RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7005775263645277`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999534491894245`*^9, 3.6999534617865334`*^9}, 
   3.700577553579844*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7005775502961164`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999534907540274`*^9, 3.699953498584552*^9}, 
   3.7005775732213397`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.700392627341243*^9, 3.7005775604517274`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999575450309443`*^9, 3.699957562438466*^9}, {
   3.699974711899658*^9, 3.699974737264982*^9}, 3.700580515475171*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6999580698593793`*^9, 3.6999580708361273`*^9}, {
   3.699974740404091*^9, 3.69997476675657*^9}, {3.700578308430024*^9, 
   3.7005783324761906`*^9}, {3.700578566604467*^9, 3.7005785698341618`*^9}, {
   3.700578650655116*^9, 3.700578658804418*^9}, {3.7005787533292065`*^9, 
   3.700578804765317*^9}, {3.700578940795519*^9, 3.7005789813596478`*^9}, {
   3.7005791165936737`*^9, 3.700579124822426*^9}, {3.700579299808877*^9, 
   3.7005793436956573`*^9}, {3.70057937935752*^9, 3.700579415453438*^9}, 
   3.7005794880111384`*^9, {3.700579525922323*^9, 3.700579537438947*^9}, {
   3.700579609197071*^9, 3.7005796126547546`*^9}, {3.7005796906490836`*^9, 
   3.700579775351965*^9}, {3.7005798101942415`*^9, 3.7005799407232313`*^9}, {
   3.700579971132533*^9, 3.700579974456066*^9}, {3.7005800176012807`*^9, 
   3.7005803845034084`*^9}, 3.700580563755313*^9, {3.700580604491683*^9, 
   3.7005806624478188`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999593332907157`*^9, 3.699959341978237*^9}, {
   3.6999616093131404`*^9, 3.6999616107935658`*^9}, 3.700577587368636*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6999616142207174`*^9, 3.6999616177256303`*^9}, 
   3.700577583451455*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Zeilberger Bijection", "Subsection",
 CellChangeTimes->{{3.7003946099547763`*^9, 3.700394615833289*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phi1x", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"y", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"y", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"y", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "x", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"x", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2yEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi1y", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"x", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"x", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"x", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "y", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"y", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y2xEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", "[", 
   RowBox[{"{", 
    RowBox[{"f1_", ",", "f2_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"succ", "[", 
        RowBox[{"f1", ",", "1"}], "]"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"f2", ",", "1"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"y2x", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"phi1y", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"y2x", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}],
     ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"f1", ",", "1"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"x2y", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"phi1x", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"x2y", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7003954659875636`*^9, 3.7003954665501375`*^9}, {
   3.7004021616227875`*^9, 3.70040216205937*^9}, 3.700403366729416*^9, {
   3.7004062905912075`*^9, 3.700406291682534*^9}, 3.7004069193792353`*^9, {
   3.70055882599035*^9, 3.7005588405131893`*^9}, {3.7008292864409356`*^9, 
   3.7008293344790497`*^9}, 3.700912861588565*^9, 3.701012932932724*^9, 
   3.701164618053122*^9, 3.7027500309602413`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Algorithm", "Subsection",
 CellChangeTimes->{{3.700405175833031*^9, 3.7004051783746963`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHP", "[", 
   RowBox[{"xfinal_", ",", "yfinal_"}], "]"}], ":=", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xtrans", "=", "xfinal"}], ";", 
     RowBox[{"ytrans", "=", "yfinal"}], ";", 
     RowBox[{"double", "=", "0"}], ";", 
     RowBox[{"z", "=", "0"}], ";", 
     RowBox[{"in", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"in2", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Proper", "[", 
        RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
       RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
    RowBox[{"z", "++"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", 
         RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}], ";", 
     RowBox[{"in2", "=", 
      RowBox[{"phi1", "[", 
       RowBox[{"{", 
        RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
     RowBox[{"in", "=", 
      RowBox[{"phi2", "[", "in2", "]"}]}], ";", 
     RowBox[{"xtrans", "=", 
      RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
     RowBox[{"ytrans", "=", 
      RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700407076071804*^9, 3.700407076594051*^9}, 
   3.700407472823694*^9, {3.7005804134960136`*^9, 3.700580416309373*^9}, 
   3.700829275794774*^9, 3.7009128787917624`*^9, 3.702750051153655*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["No Print Version", "Subsection",
 CellChangeTimes->{3.7009134597128096`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phi1xnp", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"y", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"y", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"y", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "x", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"x", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2yEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi1ynp", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"x", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"x", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"x", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "y", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"y", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y2xEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi1np", "[", 
    RowBox[{"{", 
     RowBox[{"f1_", ",", "f2_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"succ", "[", 
         RowBox[{"f1", ",", "1"}], "]"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IsRed", "[", 
        RowBox[{"f2", ",", "1"}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"y2x", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"phi1ynp", "[", 
          RowBox[{"y2x", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"y2x", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"y2x", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
      "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IsRed", "[", 
        RowBox[{"f1", ",", "1"}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"x2y", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"phi1xnp", "[", 
          RowBox[{"x2y", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"x2y", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"x2y", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RHPnp", "[", 
    RowBox[{"xfinal_", ",", "yfinal_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xtrans", "=", "xfinal"}], ";", 
      RowBox[{"ytrans", "=", "yfinal"}], ";", 
      RowBox[{"double", "=", "0"}], ";", 
      RowBox[{"z", "=", "0"}], ";", 
      RowBox[{"in", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"in2", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"list", "=", 
       RowBox[{"{", "}"}]}]}], ",", 
     RowBox[{"!", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Proper", "[", 
         RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
        RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
     RowBox[{"z", "++"}], ",", 
     RowBox[{
      RowBox[{"list", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", 
          RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"in2", "=", 
       RowBox[{"phi1np", "[", 
        RowBox[{"{", 
         RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
      RowBox[{"in", "=", 
       RowBox[{"phi2", "[", "in2", "]"}]}], ";", 
      RowBox[{"xtrans", "=", 
       RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
      RowBox[{"ytrans", "=", 
       RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RHPsteps", "[", 
    RowBox[{"xfinal_", ",", "yfinal_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xtrans", "=", "xfinal"}], ";", 
        RowBox[{"ytrans", "=", "yfinal"}], ";", 
        RowBox[{"double", "=", "0"}], ";", 
        RowBox[{"z", "=", "0"}], ";", 
        RowBox[{"in", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"in2", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Proper", "[", 
           RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
          RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
       RowBox[{"z", "++"}], ",", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", 
            RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"in2", "=", 
         RowBox[{"phi1np", "[", 
          RowBox[{"{", 
           RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
        RowBox[{"in", "=", 
         RowBox[{"phi2", "[", "in2", "]"}]}], ";", 
        RowBox[{"xtrans", "=", 
         RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
        RowBox[{"ytrans", "=", 
         RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Length", "[", "list", "]"}], "-", "1", "+", "double"}], 
      "]"}]}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AverageSteps", "[", 
   RowBox[{"n_", ",", "trials_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"totsteps", "=", "0"}], ";", 
       RowBox[{"try", "=", "0"}]}], ",", 
      RowBox[{"try", "<", "trials"}], ",", 
      RowBox[{"try", "++"}], ",", 
      RowBox[{
       RowBox[{"RHPnp", "[", 
        RowBox[{
         RowBox[{"DandelionTree", "[", "n", "]"}], ",", 
         RowBox[{"Prufer3Forest", "[", "n", "]"}]}], "]"}], ";", 
       RowBox[{"totsteps", "=", 
        RowBox[{"totsteps", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "-", "1", "+", "double"}], 
          ")"}]}]}]}]}], "]"}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"totsteps", "/", "trials"}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{
  3.701012970105266*^9, 3.7011646457435603`*^9, 3.7027500890353265`*^9, {
   3.7028080008274326`*^9, 3.7028080018882785`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1350, 709},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 111, 1, 90, "Title"],
Cell[CellGroupData[{
Cell[716, 27, 113, 1, 63, "Section"],
Cell[832, 30, 21928, 606, 1836, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22797, 641, 150, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[22972, 647, 114, 1, 43, "Subsection"],
Cell[23089, 650, 358, 9, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23484, 664, 246, 3, 43, "Subsection"],
Cell[23733, 669, 1324, 34, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25094, 708, 200, 3, 43, "Subsection"],
Cell[25297, 713, 1506, 41, 50, "Input"],
Cell[26806, 756, 1501, 40, 50, "Input"],
Cell[28310, 798, 1452, 40, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29799, 843, 158, 2, 43, "Subsection"],
Cell[29960, 847, 1475, 40, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31472, 892, 169, 2, 43, "Subsection"],
Cell[31644, 896, 655, 18, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32336, 919, 239, 5, 43, "Subsection"],
Cell[32578, 926, 2456, 67, 107, "Input"],
Cell[35037, 995, 2797, 74, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37871, 1074, 186, 4, 43, "Subsection"],
Cell[38060, 1080, 3160, 76, 88, "Input"],
Cell[41223, 1158, 2218, 63, 88, "Input"],
Cell[43444, 1223, 2143, 62, 88, "Input"],
Cell[45590, 1287, 2271, 63, 88, "Input"],
Cell[47864, 1352, 2224, 63, 107, "Input"],
Cell[50091, 1417, 70, 1, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50198, 1423, 118, 2, 43, "Subsection"],
Cell[50319, 1427, 70, 1, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50426, 1433, 118, 2, 43, "Subsection"],
Cell[50547, 1437, 92, 1, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50676, 1443, 162, 2, 43, "Subsection"],
Cell[50841, 1447, 950, 13, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51828, 1465, 166, 2, 43, "Subsection"],
Cell[51997, 1469, 122, 2, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52156, 1476, 110, 1, 43, "Subsection"],
Cell[52269, 1479, 49079, 1132, 3223, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101385, 2616, 105, 1, 43, "Subsection"],
Cell[101493, 2619, 1622, 45, 240, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103152, 2669, 82, 1, 43, "Subsection"],
Cell[103237, 2672, 50459, 1188, 3451, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

